// Protocol buffers definition for Silo server

syntax = "proto3";
package pt.tecnico.sauron.silo.grpc;

import "google/protobuf/timestamp.proto";

enum ResponseMessage {
    SUCCESS = 0;
    INIT_FAIL = 1;
    CLEAR_FAIL = 2;
    
}

message PingRequest {
    string message = 1;
}

message PingResponse {
    string message = 1;
}

message InitRequest { // TODO: fill later
}

message InitResponse {
    ResponseMessage response = 1;
}

message ClearRequest {
}

message ClearResponse {
}

message ReportRequest {

}

message ReportResponse {
    ResponseMessage response = 1;
}

message ObservationMessage {
    string type = 1;
    string id = 2;
    google.protobuf.Timestamp timestamp = 3;
}

message SearchResponse {
  repeated ObservationMessage observation = 1;
}

message SearchRequest {
    string type = 1;
    string id = 2;
}

message CameraRegistrationRequest {    
    string name = 1;
    double latitude = 2; // assure precision to 6 decimal cases (float barely reaches 5 at 128-256 range)
    double longitude = 3;
}

message CameraRegistrationResponse {    
    ResponseMessage response = 1;
}

message CameraInfoRequest {
    string name = 1;    
}

message CameraInfoResponse {
    string latitude = 1;
    string longitude = 2;
}

// service

service Sauron {
    rpc ctrlPing(PingRequest) returns (PingResponse);
    rpc ctrlClear(ClearRequest) returns (ClearResponse);
    rpc track(SearchRequest) returns (ObservationMessage);
    rpc camJoin(CameraRegistrationRequest) returns (CameraRegistrationResponse);
    rpc camInfo(CameraInfoRequest) returns (CameraInfoResponse);
    rpc trace(SearchRequest) returns (SearchResponse);
    rpc trackMatch(SearchRequest) returns (SearchResponse);
}
